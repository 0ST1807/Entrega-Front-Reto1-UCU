<div class="dashboard">
  <mat-toolbar color="primary">
    <span>Member Dashboard</span>
    <span class="spacer"></span>
    <button mat-button color="accent" type="button" (click)="logout()">
      Log out
    </button>
  </mat-toolbar>

  <div class="content">
    <mat-card class="form-card">
      <mat-card-header>
        <mat-card-title>{{ editingPerson ? 'Edit Person' : 'New Person' }}</mat-card-title>
        <mat-card-subtitle>
          Complete the details to {{ editingPerson ? 'update' : 'create' }} a record
        </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form class="person-form" [formGroup]="form" (ngSubmit)="submit()">
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Name</mat-label>
              <input matInput formControlName="nombre" placeholder="Enter name">
              <mat-error *ngIf="form.get('nombre')?.hasError('required')">
                Name is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="apellido" placeholder="Enter last name">
              <mat-error *ngIf="form.get('apellido')?.hasError('required')">
                Last name is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Age</mat-label>
              <input matInput type="number" formControlName="edad" min="0" max="100">
              <mat-error *ngIf="form.get('edad')?.hasError('required')">
                Age is required
              </mat-error>
              <mat-error *ngIf="form.get('edad')?.hasError('min') || form.get('edad')?.hasError('max')">
                Enter a valid age!
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Email</mat-label>
              <input matInput type="email" formControlName="email" placeholder="name@mail.com">
              <mat-error *ngIf="form.get('email')?.hasError('required')">
                Email is required
              </mat-error>
              <mat-error *ngIf="form.get('email')?.hasError('email')">
                Enter a valid email address
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Phone</mat-label>
              <input matInput formControlName="telefono" placeholder="Enter phone number">
              <mat-error *ngIf="form.get('telefono')?.hasError('required')">
                Phone is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>City</mat-label>
              <input matInput formControlName="ciudad" placeholder="Enter city">
              <mat-error *ngIf="form.get('ciudad')?.hasError('required')">
                City is required
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-actions">
            <button mat-stroked-button color="primary" type="button" (click)="cancelEdit()" *ngIf="editingPerson">
              Cancel
            </button>
            <span class="spacer"></span>
            <button mat-raised-button color="accent" type="submit" [disabled]="form.invalid || isSaving">
              {{ editingPerson ? 'Update' : 'Create' }}
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>

    <mat-card class="table-card">
      <mat-card-header>
        <mat-card-title>Member List</mat-card-title>
      </mat-card-header>
      <mat-card-content>
      <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>  <!-- queda mas pillo-->

        <div class="table-wrapper">
          <table mat-table [dataSource]="dataSource">

            <ng-container matColumnDef="nombre">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let person">{{ person.nombre }}</td>
            </ng-container>

            <ng-container matColumnDef="apellido">
              <th mat-header-cell *matHeaderCellDef>Last Name</th>
              <td mat-cell *matCellDef="let person">{{ person.apellido }}</td>
            </ng-container>

            <ng-container matColumnDef="edad">
              <th mat-header-cell *matHeaderCellDef>Age</th>
              <td mat-cell *matCellDef="let person">{{ person.edad }}</td>
            </ng-container>

            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef>Email</th>
              <td mat-cell *matCellDef="let person">{{ person.email }}</td>
            </ng-container>

            <ng-container matColumnDef="telefono">
              <th mat-header-cell *matHeaderCellDef>Phone</th>
              <td mat-cell *matCellDef="let person">{{ person.telefono }}</td>
            </ng-container>

            <ng-container matColumnDef="ciudad">
              <th mat-header-cell *matHeaderCellDef>City</th>
              <td mat-cell *matCellDef="let person">{{ person.ciudad }}</td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="actions-column">Actions</th>
              <td mat-cell *matCellDef="let person" class="actions-column">
                <button mat-icon-button color="primary" type="button" (click)="startEdit(person)" aria-label="Edit">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" type="button" (click)="delete(person)" aria-label="Delete">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            <tr mat-no-data-row *matNoDataRow>
              <td class="no-data" colspan="7">No records to display</td>
            </tr>
          </table>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
